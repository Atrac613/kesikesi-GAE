<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=320, user-scalable=no /">

<link href='http://fonts.googleapis.com/css?family=Terminal+Dosis' rel='stylesheet' type='text/css'>

<style type="text/css">
	* {
		-webkit-touch-callout:none;
	}
	
	body {
		background-image: url(https://twimg0-a.akamaihd.net/profile_background_images/26365115/stripe_8775e6a92916944f4bfa76a79d845088.png);
		font-family: 'Terminal Dosis', sans-serif;
	}
	
	span {
		font-weight: bold;
	}
</style>

<script type="text/javascript" src="https://www.google.com/jsapi"></script>

<script language="Javascript" type="text/javascript">
	google.load("jquery", "1");
	google.load("jqueryui", "1");
</script>

<script language="Javascript" type="text/javascript">
	var date = '{{ date }}';
	var loading = false;
	$(function() {
		$("#loadMore").click(function(){
			if (loading) {
				return;
			}
			loading = true;
			$("#loadMore span").text("Loading");
			$.post('/page/api/archive_load_more', {date: date}, function(data){
				for (i in data['data']) {
					img = '<div style="background-color: #CCCCCC;border-radius: 5px;width: 48px; height:48px;float: left;margin: 6px;">';
					img += '<a href="/'+ data['data'][i]['image_key'] +'"><img src="/api/get_image?id='+ data['data'][i]['image_key'] +'&style=icon48" style="border-radius: 5px;" /></a>';
					img += '</div>';
					console.log(data['data'][i]['image_key']);
					$("#archiveList").append(img);
				}
				date = data['date'];
				if (date === false) {
					$("#loadMore").hide();
				}
				console.log('date:' + date);
				$("#loadMore span").text("Load More");
				loading = false;
			}, "json");
		});
		
{% if load_more_hide %}
		$("#loadMore").hide();
{% endif %}
		
	});
</script>

<script type="text/javascript">
$(function() {
{% ifequal action 'login' %}
	window.location = "ksks://www.kesikesi.me/page/login/success";
{% endifequal %}
});
</script>

<title>My Archives - KesiKesi</title>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-1167116-20']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</head>
<body>
	
<div style="position:relative;border-radius: 5px; background-color: rgba(0,51,102,0.4);text-align: center;padding: 5px;color: #FFFFFF;margin-top:5px;margin-bottom:5px;">
	<span>My Archives</span>
</div>

<div id="archiveList" style="margin-left: 3px;">
{% for archive in archive_list %}
<div style="background-color: #CCCCCC;width: 48px; height:48px;float: left;margin: 6px;border-radius: 5px;">
	<a href="/{{ archive.image_key }}"><img src="/api/get_image?id={{ archive.image_key }}&style=icon48" style="border-radius: 5px;" /></a>
</div>
{% endfor %}
</div>

<div style="clear: both;padding-top: 10px;">
	<div id="loadMore" style="margin:0 auto;width:130px;border-radius: 5px;background-color: rgba(0,51,102,0.4);text-align: center;padding: 5px;color: #FFFFFF;margin-top:5px;margin-bottom:5px;">
		<span>Load More</span>
	</div>
</div>

<hr />

<center><p>{{ account }}</p></center>

<hr />

<center><p><a href="/page/archive">Home</a> | <a href="/page/settings">Settings</a> | <a href="{{ logout_url }}">Logout</a></p></center>

</body>
</html>